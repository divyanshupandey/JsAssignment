<!DOCTYPE html>
<html>
<meta charset="utf-8">
<!--style the css  -->
<style>

h1
{
  color: orange;
}
.arc text {
  font: 10px sans-serif;
  text-anchor: middle;
}

.rect {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 80%;
}

.arc path {
  stroke: #fff;
}
.tooltip {
  background: #eee;
  box-shadow: 0 0 5px #999999;
  color: #333;
  display: none;
  font-size: 19px;
  left: 305px;
  padding: 10px;
  position: absolute;
  text-align: center;
  top: 350px;
  width: 120px;
  z-index: 10;
}

</style>
<body>
  <h1 align="center">Education category-wise Literate Population</h1>
  <script src="//d3js.org/d3.v3.min.js"></script>
  <script>
  var list=[];
  var width = 1460,
  height = 600,
  radius = Math.min(width, height) / 2;

  var color = d3.scale.category20();

  //Define the arc and radius
  var arc = d3.svg.arc()
  .outerRadius(radius - 10)
  .innerRadius(radius - 175);

  var labelArc = d3.svg.arc()
  .outerRadius(radius - 40)
  .innerRadius(radius - 40);

  var pie = d3.layout.pie()
  .sort(null)
  .value(function(d) { return d["Lit-Population"]; });

  //add the svg element
  var svg = d3.select("body").append("svg")
  .attr("width", width)
  .attr("height", height)
  .append("g")
  .attr("transform", "translate(" + width/4 + "," + height/2 + ")");

  //define the tooltip
  var tooltip = d3.select("body").append("div")
  .attr('class', 'tooltip');
  tooltip.append('div')
  .attr('class', 'label');
  tooltip.append('div')
  .attr('class', 'count');
  tooltip.append('div')
  .attr('class', 'percent');

  //load the data
  d3.json("../json/edCategVsLit.json", function(error, data) {
    if (error) throw error;

    data.forEach(function(d) {
      d["Category"] = d["Category"];
      list.push(d["Category"]);
      d["Lit-Population"] = +d["Lit-Population"];
    });

    // add the arc
    var g = svg.selectAll(".arc")
    .data(pie(data))
    .enter().append("g")
    .attr("class", "arc");

    //add the pie
    g.append("path")
    .attr("d", arc)
    .style("fill", function(d) { return color(d.data["Category"]); });

    //add the tooltip
    g.on('mouseover', function(d) {
      var total = d3.sum( data.map(function(d) {
        return d["Lit-Population"];
      }));
      var percent = Math.round(1000 * d.data["Lit-Population"] / total) / 10;
      tooltip.select('.label').html(d.data.label);
      tooltip.select('.count').html(d.data["Lit-Population"]);
      tooltip.select('.percent').html(percent + '%');
      tooltip.style('display', 'block');
    });

    g.on('mouseout', function() {
      tooltip.style('display', 'none');
    });

    var rect = svg.selectAll(".rect")
    .data(color.domain().slice())
    .enter().append("g")
    .attr("class", "rect")
    .attr("transform", function(d, i) { return "translate(0," + i * 30 +
    ")";
  });

  //add the legend element rect
  rect.append("rect")
  .attr("x", width - 480)
  .attr("y", -120)
  .attr("width", 18)
  .attr("height", 18)
  .style("fill", color);

  rect.append("text")
  .attr("x", width - 800)
  .attr("y", -110)
  .attr("dy", ".35em")
  .style("text-anchor", "middle")
  .style("text","comic")
  .style("fill","black")
  .style("font-size","15px")
  .text(function(d,i) { return list[i]; });
});

</script>
</body>
</html>
